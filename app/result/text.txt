Pour comprendre le Virtual DOM, voici une vidéo :

<MuxVideo
  name="0.virtual-dom-2.mov"
  id="01mf4mWJphTnIJlq011SZkWggS0202gnBMQHQzT6DPukg400"
/>

## Render et commit

Pour chaque changement de ton application, React va `render` tes composants puis `commit` les les changements nécessaires.

### Render

Le render comme on l'a vu se produit lorsqu'un composant est instancié ou lorsqu'un changememnt de state se produit (le `setStte`).

Le render c'est tout simplement le fait de "re-run" ton composant entièrement !

<Playground
  template="react" 
  showConsole
  files={{
    "App.js":`import { useReducer } from "react";
    
export default function App() {
  const [countr, setCounter] = useReducer((s) => s + 1, 0);

console.log("[App] Je suis re-render !")

return (
<div>
<Input aria-label={key} key={key} />
<button onClick={() => setCounter(counter + 1)}>Rerender</button>
</div>
)
}

const User = () => {
console.log("[User] Je suis re-render !")

return <input />
}

`}}
/>

Ici, chaqque fois qe tu cliques sur le button `rerender`, tu vas provoquer un render qui va en fait re-run chacune de nos functions (tu peux le voir dans la console).

Ensuite, React va prendre le résultat pour passer à la phase de commit.

### Commit

Le commit c'est le fait de mettre à jour le DOM en fonction des changements.

Pour le premier render, React va ajouter chaque élément React aux dom en utilisant [appendChild()](https://deeloper.mozilla.org/en-US/docs/Web/API/Node/appendChild).

Lors des prochains render, ReactDOM va comparer le DOM actuel et le futur DOM calculé lors de la phase de render, il vas ensuite update **uniquement les éléments différents** comme on l'a vu dans la vidéo.

## Conclusion

React va re-calculer chaque composant à chaque changement mais ne va update que les éléments qui ont changé entre les render, ce qui améliore les performances.

## Quizz

<Quiz
  id="render-commit-3"
  answers={[
    "React met à jour tous les éléments du DOM",
    "React ne met à jour que les éléments qui ont changé",
  ]}
  correctAnswerIndex={1}
  correctAnswer="React met à jour tous les éléments du DOM"
>
  Que se passe-t-il lors d'un render et commit dans React ?
</Quiz>

<Quiz
  id="render-commit-2"
  answers={[
    "Lorsqu'un composant est instancié",
    "Lorsqu'un changement de state se produit",
    "Les deux",
  ]}
  correctAnswerIndex={2}
  correctAnswer="Les deux"
>
  Dans quelles situatons se produit le render dans React ?
</Quiz>

<Quiz
  id="render-commit-1"
  answers={[
    "Le render re-calcule tous les éléments React de notre application",
    "Le commit met à jour le DOM en fonction des changements",
  ]}
  correctAnswerIndex={1}
  correctAnswer="Le commit met à jour le DOM en fonction des changements"
>
  Qu'est-ce que le commit dans React ?
</Quiz>
